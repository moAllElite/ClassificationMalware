import numpy as np
import joblib
from flask import Flask, request, jsonify, render_template

app = Flask(__name__)

# Charger le modèle
model = joblib.load("ClassificationMalwareBestModel.pkl")

@app.route('/')
def home():
    return render_template('index.html')

@app.route("/predict", methods=["POST"])
def predict():
    '''
        For rendering results on HTML GUI
    '''
    # Récupérer les données du formulaire
    features = []
    features.append(float(request.form['MajorLinkerVersion']))
    features.append(float(request.form['MajorImageVersion']))
    features.append(float(request.form['MajorOperatingSystemVersion']))
    features.append(float(request.form['SizeOfStackReserve']))
    features.append(float(request.form['NumberOfSections']))
    features.append(float(request.form['ResourceSize']))
    features.append(float(request.form['legitimate']))
    # Faire la prédiction avec le modèle
    prediction = model.predict([features])
    print('It\'s a malawre $ {}'.format(int(prediction[0]))
    return render_template('index.html', prediction_text='It\'s a malawre $ {}'.format(int(prediction[0])))

if __name__ == "__main__":
    app.run(debug=True)
